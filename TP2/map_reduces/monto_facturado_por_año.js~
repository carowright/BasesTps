/* PERMITE RESOLVER:
 *	El monto total facturado por a単o. */
var mapFn = function (){
	var monto = 0;
	if (this.abono != null)
		monto = monto + this.abono;
	if (this.comision != null)
		monto = monto + this.comision;

	emit(this.fecha.a単o, monto);
};

var reduceFn = function (a単o, montos){
	return Array.sum(montos);
};

var options = {
	out: 'monto_facturado_por_a単o'
};

db.facturas.mapReduce(mapFn, reduceFn, options)
