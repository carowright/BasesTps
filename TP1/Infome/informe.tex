\documentclass[10pt,a4paper]{article}
\usepackage[utf8]{inputenc} % para poder usar tildes en archivos UTF-8
\usepackage[spanish]{babel} % para que comandos como \today den el resultado en castellano
\usepackage{a4wide} % márgenes un poco más anchos que lo usual
\usepackage[conEntregas]{caratula}
\usepackage{ulem}
\usepackage{amsmath} 
\usepackage{amssymb}
\usepackage{fancybox}
\usepackage[usenames,dvipsnames]{color}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{clrscode3e}
\usepackage{xcolor}
\usepackage{amsmath}
\usepackage{arydshln}

\hypersetup{
    colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=black
}

\lstdefinestyle{customc}{
  belowcaptionskip=1\baselineskip,
  breaklines=true,
  frame=L,
  xleftmargin=\parindent,
  language=C,
  showstringspaces=false,
  basicstyle=\footnotesize\ttfamily,
  keywordstyle=\bfseries\color{green!40!black},
  commentstyle=\itshape\color{purple!40!black},
  identifierstyle=\color{blue},
  stringstyle=\color{orange},
}

\lstset{escapechar=@,style=customc}

\begin{document}

\titulo{Trabajo Práctico 1}
\subtitulo{[Primera entrega]}

\fecha{\today}

\materia{Bases de Datos}
\integrante{Fernandez, Esteban}{691/12}{esteban.pmf@gmail.com}
\integrante{Marta, Cristian G.}{079/12}{cristiangmarta@gmail.com}
\integrante{Podavini Rey, Martín Gastón}{483/12}{marto.rey2006@gmail.com}
\integrante{Wright, Carolina Rocío}{876/12}{wright.carolina@gmail.com}

\maketitle

\tableofcontents
\newpage

\section{Introducción}
El problema a resolver mediante el uso de bases de datos relacional es el del registro de los Casos Criminales en un sitio. Para llevar cuenta de ellos se tiene en cuenta los diversos aspectos que los componen, por ejemplo, los oficiales de policia (quienes pertenecen a sus correspondientes departamentos de policia los cuales fueron modelados tambien) encargados de documentar y resolver los crimenes junto a las demas personas que participaron de alguna manera (con sus respectivos roles) en el caso que se registra. Estos tendrán información asociada que los identifica y describe. \\
Los casos, como entidad, pueden encontrarse en diferentes estados (congelado, descartados, resuelto etc) y en cada uno de ellos se proveerá diferente tipo información ligada al estado en si del caso. \\
La utilización del modelo relacional nos permitirá  administrar esta información de la manera mas modular y ordenada posible, permitiéndonos así poder asociar, consultar y mantener la información de las diferentes entidades que conforman el registro de los Casos Criminales de una manera eficiente aprovechando el motor de las bases de datos relacionales SQL.
\section{MER y MR}

\subsection{Modelo de Entidad Relación}

\subsection{Modelo Relacional}
En esta sección presentamos el diseño lógico, obtenido a partir del Modelo de Entidad Relación. 
\newline
\newline
Testimonio(\underline{id}, texto, hora, fecha, \dashuline{numeroPlacaPolicia})\\
	PK = CK = \{id\}\\ 
	FK = \{numeroPlacaPolicia\}\\ 
\newline
Evidencia(\underline{id}, fechaIngreso, descripcion, fechaEncuentro, horaEncuentro, fechaSellado, horaSellado, \dashuline{idCaso})\\ 
	PK = CK = \{id\} \\
	FK = \{idCaso\}\\ 
\newline
Custodia(\underline{id}, fecha, hora, comentario, \dashuline{idEvidencia}, \dashuline{numeroPlacaPolicia})\\ 
	PK = CK = \{id\} \\
	FK = \{idEvidencia, numeroPlacaPolicia\}\\ 
\newline
Direccion(\underline{id}, numero, calle)\\ 
	PK = CK = \{id\}\\ 
\newline
CasoCriminal(\underline{id}, fechaIngreso, fecha, hora, lugar, descripcion, \dashuline{nombreCategoria})\\ 
	PK = CK = \{id\}\\ 
	FK = \{nombreCategoria\}\\ 
\newline
Congelado(\dashuline{idCaso}, fecha, comentario)\\ 
	PK = CK = FK = \{idCaso\}\\ 
\newline
\textit{Congelado.idCaso} tiene que estar en \textit{CasoCriminal.id}
\newline
\newline
Descartado(\dashuline{idCaso}, fecha, motivo)\\ 
	PK = CK = FK = \{(idCaso)\}\\ 
\newline
\textit{Descartado.idCaso} tiene que estar en \textit{CasoCriminal.id}
\newline
\newline
Resuelto(\dashuline{idCaso}, fecha, descripcion, \dashuline{numeroPlacaPolicia})\\ 
	PK = CK = \{idCaso\}\\ 
	FK = \{idCaso, numeroPlacaPolicia\}\\ 	
\newline
\textit{Resuelto.idCaso} tiene que estar en \textit{CasoCriminal.id}
\newline
\newline
Categoria(\underline{nombre})\\ 
	PK = CK = \{nombre\}\\ 
\newline
Rol(\underline{nombre})\\ 
	PK = CK = \{nombre\}\\ 
\newline
Persona(\underline{dni}, fechaNacimiento, nombre, apellido, \dashuline{idDireccion})\\ 
	PK = CK = \{dni\}\\ 
	FK = \{idDireccion\}\\ 
\newline
Telefono(\underline{\underline{dni}}, \underline{numero})\\ 
	PK = CK = \{numero\}\\
	FK = \{dni\}\\ 
\newline
Evento(\underline{idEvento}, descripcion, hora, fecha, \dashuline{nombreRol, idCaso, dni})\\ 
	PK = CK  = \{idEvento\}\\ 
	FK = \{nombreRol, idCaso, dni\}\\
\newline
OficialDePolicia(\underline{numeroDePlaca}, fechaIngreso, numeroEscritorio, \dashuline{nombreRango}, \dashuline{nombreDepartamento})\\
	PK = CK = \{numeroDePlaca\}\\ 
	FK = \{nombreRango, nombreDepartamento\}\\
\newline
Servicio(\underline{nombre})\\ 
	PK = CK = \{nombre\}\\ 
\newline
Departamento(\underline{nombre}, lineaTelefonica, \dashuline{nombreLocalidad}, \dashuline{nombreSupervisa})\\ 
	PK = CK = \{nombre\}\\ 
	FK = \{nombreLocalidad, nombreSupervisa\}\\
\newline
LineaTelefonica(\underline{numero}, \underline{\underline{nombreDepartamento}})\\ 
	PK = CK = \{numero, nombreDepartamento\}\\ 
	FK = \{nombreDepartamento\}\\
\newline
Localicad(\underline{nombre})\\ 
	PK = CK = \{nombre\}\\ 
\newline
Rango(\underline{nombre})\\ 
	PK = CK = \{Nombre\}\\ 
\newline
Declara(\underline{\underline{idTestimonio, idCaso, dni}})\\ 
	PK = CK = FK = \{idTestimonio, idCaso, dni\}\\
\newline
Tiene(\underline{\underline{nombreRol, idCaso, dni}})\\ 
	PK = CK = FK = \{nombreRol, idCaso, dni\}\\ 
\newline
Culpable(\underline{\underline{dni, idCaso}})\\ 
	PK = CK = FK = \{dni, idCaso\}\\ 

\section{Diseño Físico}
Creación de las tablas.

\begin{verbatim}
CREATE TABLE Testimonio(
id integer PRIMARY KEY,
texto char(15) not null,
hora time not null,
fecha date not null,
FOREIGN KEY (numeroPlacaPolicia) REFERENCES OficialDePolicia(numeroPlacaPolicia)
);

CREATE TABLE Evidencia(
id integer PRIMARY KEY,
fechaIngreso date not null,
descripcion char(128) not null,
fechaEncuentro date not null,
horaEncuentro time not null,
fechaSellado date not null,
horaSellado time not null,
FOREIGN KEY (idCaso) REFERENCES CasoCriminal(idCaso)
);

CREATE TABLE Custodia(
id integer PRIMARY KEY,
fecha date not null,
hora time not null,
comentario char(128) not null,
FOREIGN KEY (idEvidencia) REFERENCES Evidencia(idEvidencia),
FOREIGN KEY (numeroPlacaPolicia) REFERENCES OficialDePolicia(numeroPlacaPolicia)
);

CREATE TABLE Direccion(
id integer primary key,
numero integer not null,
calle char(30) not null 
);

CREATE TABLE CasoCriminal(
id integer primary key,
fechaIngreso date not null,
fecha date not null,
hora time not null,
lugar char(15) not null,
descripcion char(128) not null,
foreign key (nombreCategoria) references Categoria(nombreCategoria)
);

CREATE TABLE Congelado(
id integer primary key references CasoCriminal(id),
fecha date not null,
comentario char(15) not null
);

CREATE TABLE Descartado(
idCaso integer primary key references CasoCriminal(idCaso),
fecha date not null,
motivo char(15)
);

CREATE TABLE Resulto(
idCaso integer primary key references CasoCriminal(idCaso),
fecha date not null,
descripcion char(15),
FOREIGN KEY (numeroPlacaPolicia) REFERENCES OficialDePolicia(numeroPlacaPolicia)
);

CREATE TABLE Pendiente(
idCaso integer primary key references CasoCriminal(idCaso),
fecha date not null,
comentario char(15)
);

CREATE TABLE Categoria(
nombre char(15) primary key
);

CREATE TABLE Rol(
nombre char(15) primary key
);

CREATE TABLE Persona(
dni integer primary key,
fechaNacimiento date not null,
nombre char(15) not null,
apellido char(15) not null,
foreign key (idDireccion) references Direccion(idDireccion)
);

CREATE TABLE Telefono(
numero integer primary key,
foreign key (dni) references Persona(dni)
);

CREATE TABLE Evento(
id integer primary key,
descripcion char(128) not null,
hora time not null,
fecha date not null,
foreign key (nombreRol) references Rol(nombreRol),
foreign key (idCaso) references CasoCriminal(idCaso),
foreign key (dni) references Persona(dni)
);

CREATE TABLE OficialDePolicia(
numeroDePlaca integer primary key,
fechaDeIngreso date not null,
foreign key (nombreDeRango) references Rango(nombreRango),
foreign key (nombreDeDepartamento) references Departamento(nombreDepartamento),
numeroDeEscritorio integer
);

CREATE TABLE Servicio(
nombre char(15) primary key
);

CREATE TABLE Departamento(
nombre char(15) primary key,
lineaTelefonica integer,
foreign key (nombreLocalidad) references Localidad(nombreLocalidad),
foreign key (nombreSupervisa) references Departamento(nombreSupervisa)
);

CREATE TABLE LineaTelefonica(
numero int primary key,
nombreDepartamento char(15) primary key references Departamento(nombreDepartamento)
);

CREATE TABLE Localidad(
nombre char(15) primary key
);

CREATE TABLE Rango(
nombre char(15) primary key
);

CREATE TABLE Declara(
idTestimonio integer primary key references Testimonio(idTestimonio),
idCaso integer primary key references CasoCriminal(idCaso),
dni integer primary key references Persona(dni)
);

CREATE TABLE Tiene(
nombreRol char(15) primary key references Rol(nombreRol),
idCaso integer primary key references CasoCriminal(idCaso),
dni integer primary key references Persona(dni)
);

CREATE TABLE Culpable( 
idCaso integer primary key references CasoCriminal(idCaso),
dni integer primary key references Persona(dni)
);
\end{verbatim}
\subsection{Inserción de datos}

\section{Código}
Implementamos las siguientes funcionalidades.

\begin{itemize}
\item Datos de las personas que fueron sospechosas.
\item Direcciones donde convivieron personas sospechosas de diferentes casos
\item Oficiales que participaron en la cadena de custodia de evidencias para más de un
caso.
\item La sucesión de eventos de personas involucradas en un caso.
\item Un ranking de oficiales exitosos, es decir los que cerraron mayor cantidad de casos
(resueltos).
\item Las ubicaciones de todas las evidencias de un caso.
\item La lista de oficiales involucrados en un caso.
\item Las categorías de casos ordenadas por cantidad de casos
\item Todos los testimonios de un caso dado
\item Para una categoría en particular listar, para cada uno de los casos, los testimonios
asociados
\end{itemize}
\section{Conclusion}

\end{document}